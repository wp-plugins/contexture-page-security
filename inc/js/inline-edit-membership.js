(function(a){inlineEditMembership={init:function(){a("a.editmembership").live("click",function(){inlineEditMembership.edit(this);return false});a(".submit a.cancel").live("click",function(){var b=a(this).parents("tr:first"),d=inlineEditMembership.getId(b[0]);b.remove();a("#user-"+d).css("display","table-row")});a(".submit a.save").live("click",function(){var b=a(this).parents("tr:first");inlineEditMembership.save(b[0])});a('input[name="membership_permanent"]').live("click",function(){a(this).filter(":checked").length>
0?a(this).parents("fieldset:first").find(".inline-edit-date").find("input, select").removeAttr("disabled"):a(this).parents("fieldset:first").find(".inline-edit-date").find("input, select").attr("disabled","disabled")});a(".row-actions .trash").click(function(){return confirm(msgRemoveUser)})},edit:function(b){var d,e,c=false;inlineEditMembership.revert();if(typeof b=="object")b=inlineEditMembership.getId(b);d=a("#inline_"+b);e=a("#inline-edit").clone().attr("id","edit-"+b).insertAfter("#user-"+b).css("display",
"table-row");a(".username",e).text(a(".username",d).text());if(a(".jj",d).text().length!=0){a('input[name="membership_permanent"]',e).attr("checked","checked");c=true}c&&e.find(".inline-edit-date").find("input, select").removeAttr("disabled").filter('[name="mm"]').val(a(".mm",d).text()).end().filter('[name="aa"]').val(a(".aa",d).text()).end().filter('[name="jj"]').val(a(".jj",d).text()).end();a("#user-"+b).hide()},save:function(b){var d,e,c,h="",g=0;a(".inline-edit-save .waiting").show();b=inlineEditMembership.getId(b);
e=a("#inline_"+b);d=a("#edit-"+b);c={grel:e.find(".grel").text(),mon:d.find('select[name="mm"]').val(),day:d.find('input[name="jj"]').val(),yr:d.find('input[name="aa"]').val()};if(d.find('[name="membership_permanent"]:checked').length!=0){g=1;h=c.yr+"-"+c.mon+"-"+c.day}else{c.mon="";c.day="";c.yr=""}a.post("admin-ajax.php",{action:"ctx_ps_updatemember",grel:c.grel,expires:g,date:h},function(f){f=a(f);if(f.find("code").text()=="1"){a("#user-"+b).find(".column-expires").text(g==1?c.mon+"-"+c.day+"-"+
c.yr:"Never");e.find(".jj").text(c.day);e.find(".mm").text(c.mon);e.find(".aa").text(c.yr);inlineEditMembership.revert();a("#user-"+b).animate({"background-color":"#e0ffe3"},250,function(){a(this).animate({"background-color":"#ffffff"},1E3)})}else{a(".inline-edit-save .waiting").hide();alert(f.find("message").text())}},"xml")},revert:function(){a("tr.inline-edit-row:visible").each(function(){var b=inlineEditMembership.getId(a(this)[0]);a(this).remove();a("#user-"+b).css("display","table-row")})},
getId:function(b){b=(b.tagName=="TR"?b.id:a(b).parents("tr:first").attr("id")).split("-");return b[b.length-1]}};a(document).ready(function(){inlineEditMembership.init()})})(jQuery);